{% extends "base.html" %}
{% block title %}{{ product.name }} • STREETLAB{% endblock %}

{% block content %}
<section class="product">
  <div class="product__wrap">

    <!-- IMAGEM -->
    <div class="product__media">
      <div class="product__img"
        style="background-image: url('{{ url_for('static', filename='uploads/' ~ product.image) }}');">
      </div>
    </div>

    <!-- INFO -->
    <div class="product__info">
      <h1 class="product__title">{{ product.name }}</h1>
      <div class="product__price">R$ {{ product.price }}</div>

      <p class="product__desc">
        {{ product.description }}
      </p>

      {% if stock|length == 0 %}
        <p class="muted">Produto sem estoque cadastrado.</p>
      {% else %}

      <!-- FORM CARRINHO -->
      <form method="POST" action="{{ url_for('add_to_cart', slug=product.slug) }}" id="addToCartForm">

      <!-- OPÇÕES DE TAMANHO -->
      <div class="product__options">
        {% for s in stock %}
          <button
            type="button"
            class="option {% if s.quantity == 0 %}disabled{% endif %}"
            {% if s.quantity == 0 %}disabled{% endif %}
            data-size="{{ s.size }}">
            {{ s.size }}
          </button>
        {% endfor %}
      </div>

      <form method="POST" action="{{ url_for('add_to_cart', slug=product.slug) }}">
        <input type="hidden" name="size" id="selectedSize">

        {% if logged %}
          <button type="submit" class="btn btn--primary">Adicionar ao carrinho</button>
        {% else %}
          <a href="{{ url_for('login', next=request.path) }}" class="btn btn--primary">
            Faça login para comprar
          </a>
        {% endif %}
      </form>



      {% endif %}

    </div>
  </div>
</section>

<script src="{{ url_for('static', filename='js/product.js') }}"></script>

{% endblock %}

